zou90512
博客园
首页
新随笔
联系
订阅
管理
随笔 - 45  文章 - 1  评论 - 39
Netty4.x中文教程系列(七)UDP协议


　　将近快一年时间没有更新Netty的博客。一方面原因是因为项目进度的问题。另外一方面是博主有一段时间去熟悉Unity3D引擎。

　　本章节主要记录博主自己Netty的UDP协议使用。

　　1.　　构建UDP服务端
　　首先我们应该清楚UDP协议是一种无连接状态的协议。所以Netty框架区别于一般的有链接协议服务端启动程序（ServerBootstrap）。

　　Netty开发基于UDP协议的服务端需要使用Bootstrap

　　

 View Code
　　于Tcp协议的客户端启动程序基本一样。唯一区别就在于，UDP服务器使用的是bind方法，来监听端口

　　在Netty的Bootstrap类中的注释，发现有如下注释内容：

　　

　　大意就是：bind()用于UDP， TCP连接使用connect()。

　　上面的源码监听的是端口9009，那么所有使用UDP协议的数据，发送到端口9009，就会被我们的Netty接收到了。

　　为了输出方便，博主在上面的代码中增加一个MessageToMessageDecoder将接收到的Datagram，排除其他信息，仅将字符串传递下去。并在UDPHandler中打印出来。

　　2.　　构建UDP客户端
　　UDP协议来说，其实没有客户端和服务端的区别啦。只是为了贴近TCP协议做的一点文字描述上面的区分。

　　简单来讲，上面的那段逻辑其实就可以作为UDP客户端来使用。注释掉的那行逻辑其实就是发送“我是大好人啊”这个字符串到ip地址为192.168.2.29的服务端的9008端口。代码如下：

　　

 View Code
　　和上面的“服务端”代码最大的差别就是，监听的端口号修改成0.为

　　使用Netty的Channel发送DatagramPacket。写好目标地址，然后运行起来就可以自己测试一下了。

　　3.　　JAVA原生UDP
　　有朋友这个时候就会问：为什么不是有JAVA原生的UDP呢？

　　其实很简单。说白了Netty使用的也是Java底层的代码。只是做了一层封装，以便于使用。服务端使用Netty框架构建高性能，高扩展的UDP服务器。

　　客户端则使用JAVA或者任意其他的语言的API（遵循UDP协议即可）。

　　下面上一段博主使用的的JAVA

　　

 View Code
　　..

　　ps.UDP协议最大特点就是效率高，速度快。用于某些场合可以极大改善系统的性能。

　　博主在这里引入这个Netty实现UDP的服务端，主要目的。嘻嘻。就是想开源拙作：eyeOfSauron日志系统。



分类: Netty
标签: Netty, UDP
好文要顶 关注我 收藏该文
Tiny&zzh
关注 - 15
粉丝 - 55
+加关注
0 0
« 上一篇：Unity3D 5.0版本+注册工具分享
» 下一篇：Okra框架(一) 简介
posted @ 2015-06-10 21:12 Tiny&zzh 阅读(2078) 评论(5) 编辑 收藏

评论列表
   #1楼 2016-04-08 12:07 雷泡泡
楼主，请问一下为什么我运行server端之后马上终止呢？
Runtime.getRuntime().addShutdownHook(new Thread(new Runnable() {
@Override
public void run() {
nioEventLoopGroup.shutdownGracefully();
}
}));

这个是什么作用呢？
支持(0)反对(0)
   #2楼[楼主] 2016-04-08 12:39 Tiny&zzh
@ 雷泡泡
给java运行时上挂一个钩子。当程序停止运行的时候。关闭netty并且释放掉netty使用的线程池
支持(0)反对(0)
   #3楼 2016-04-08 12:57 雷泡泡
但是我把您的server端程序跑起来之后立马会终止时什么情况呢？还没等client端连接上就终止了。为什么会出现这种情况呢？我的UdpHandler是按照以下这样写的，但是接收不到client端发送的数据是什么情况呢？
public class UdpHandler extends SimpleChannelInboundHandler<DatagramPacket>{
public void messageReceived(ChannelHandlerContext ctx,DatagramPacket packet) throws Exception{
System.out.println("收到客户端发来的数据包");
}

}
支持(0)反对(0)
   #4楼[楼主] 2016-04-08 13:31 Tiny&zzh
@ 雷泡泡
有输出什么错误信息吗？
server启动就挂了应该哪里抱错了。端口占用之类的吧。
是不是我代码里面解码器吧udp协议传输的内容转成字符串了。simple里面是不是应该尝试处理String呢！
支持(0)反对(0)
   #5楼 2016-04-08 13:51 雷泡泡
嗯嗯，谢谢楼主！我已经用另外一种方法可以啦，非常感谢您的回复！非常感动！不知楼主是否使用过Netty实现P2P呢？
支持(0)反对(0)
刷新评论刷新页面返回顶部
注册用户登录后才能发表评论，请 登录 或 注册，访问网站首页。
【推荐】50万行VC++源码: 大型组态工控、电力仿真CAD与GIS源码库
【报表】Excel 报表开发18 招式，人人都能做报表
【活动】阿里云海外云服务全面降价助力企业全球布局
【实用】40+篇云服务器操作及运维基础知识！
深度学习0519
最新IT新闻:
· Windows 10 Build 16199发布 带来大量功能改进
· 小米手机一大波优惠来袭！MIX首次官降
· 迅雷9.1.32正式发布 “组队加速”优化
· KARMA中国首秀，GoPro真靠这款无人机翻身了？
· 高管贪腐数亿？摩拜单车创始人胡玮炜起诉知乎
» 更多新闻...
阿里云E4
最新知识库文章:
· 软件开发为什么很难
· 唱吧DevOps的落地，微服务CI/CD的范本技术解读
· 程序员，如何从平庸走向理想？
· 我为什么鼓励工程师写blog
· 怎么轻松学习JavaScript
» 更多知识库文章...
昵称：Tiny&zzh
园龄：5年5个月
粉丝：55
关注：15
+加关注
<	2017年5月	>
日	一	二	三	四	五	六
30	1	2	3	4	5	6
7	8	9	10	11	12	13
14	15	16	17	18	19	20
21	22	23	24	25	26	27
28	29	30	31	1	2	3
4	5	6	7	8	9	10
搜索

 找找看

 谷歌搜索
常用链接
我的随笔
我的评论
我的参与
最新评论
我的标签
我的标签
Netty(11)
silverlight(7)
java(7)
Unity3D(7)
中文教程(5)
Netty 4(5)
NIO(4)
Okra(3)
Socket(3)
C#(3)
更多
随笔分类
Java(4)
Netty(7)
Okra(3)
Unity3D(5)
随笔档案
2016年6月 (1)
2016年4月 (4)
2015年6月 (1)
2015年3月 (1)
2015年2月 (1)
2015年1月 (1)
2014年10月 (2)
2014年9月 (2)
2014年8月 (3)
2014年7月 (2)
2014年6月 (1)
2014年4月 (5)
2014年1月 (2)
2013年12月 (4)
2013年11月 (2)
2013年10月 (1)
2013年6月 (2)
2013年4月 (1)
2012年11月 (1)
2012年9月 (2)
2012年5月 (1)
2012年3月 (2)
2012年2月 (1)
2012年1月 (1)
2011年12月 (1)
相册
Res(4)
最新评论
1. Re:Netty4.x中文教程系列(四) ChannelHandler
很好,学习了.特别是对4.x和5.0的对比.
--freegf
2. Re:Netty4.x中文教程系列(一) 目录及概述
大哥，云盘地址失效了，能再分享一次吗？
--痞子色子
3. Re:[工具分享]JetBrains ReSharper 9.0 正式版和注册码
谢谢博主。也 谢谢 ReSharper。
--InkFx
4. Re:Netty4.x中文教程系列(二) Hello World !
楼主，如果有多个客户端，如何实现在已知客户端ip和port情况下在服务端向客户端发数据呢？
--1115405079
5. Re:Unity3D中uGUI事件系统简述及使用方法总结
总结得挺好
--离落
阅读排行榜
1. Netty4.x中文教程系列(二) Hello World !(18315)
2. Netty4.x中文教程系列(一) 目录及概述(18259)
3. Unity3D中uGUI事件系统简述及使用方法总结(12773)
4. Netty4.x中文教程系列(四) ChannelHandler(8743)
5. 【推荐】《Netty in action》书籍(8078)
评论排行榜
1. Netty4.x中文教程系列(二) Hello World !(9)
2. Netty4.x中文教程系列(七)UDP协议(5)
3. Netty4.x中文教程系列(一) 目录及概述(4)
4. 【推荐】《Netty in action》书籍(4)
5. [工具分享]JetBrains ReSharper 9.0 正式版和注册码(3)
推荐排行榜
1. [工具分享]JetBrains ReSharper 9.0 正式版和注册码(3)
2. JAVA笔记-如何将百万级数据高效的导出到Excel表单(3)
3. Netty4.x中文教程系列(五)编解码器Codec(2)
4. 关于Netty4.x中文教程系列更新进度的说明和道歉(1)
5. Netty4.x中文教程系列(四) ChannelHandler(1)
Copyright ©2017 Tiny&zzh